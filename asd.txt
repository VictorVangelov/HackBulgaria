package firstServletUsingTomcat;

import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.Formatter;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;

import org.apache.http.HttpEntity;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;

import sun.awt.image.ByteArrayImageSource;

import com.sun.syndication.feed.synd.SyndEntry;
import com.sun.syndication.feed.synd.SyndFeed;
import com.sun.syndication.io.SyndFeedInput;
import com.sun.syndication.io.XmlReader;

public class News {

	public static String getNews() {
		StringBuilder outputContent = new StringBuilder();
		ArrayList<SyndEntry> syndEntrys = getSyndEntrys();
		Formatter formatter = new Formatter(outputContent, Locale.US);
		String itemTemplate = " <item>      <title>%1</title>      <link>%2</link>      <description>&lt;img src=%3, alt=%4 </description>      <category></category>      <author></author>      <comments></comments>    </item>";
		formatter.format(itemTemplate,);
		for (SyndEntry entry : syndEntrys) {

		}

		return outputContent.toString();

	}

	public static ArrayList<SyndEntry> getSyndEntrys() {
		ArrayList<SyndEntry> listOfSyndEntrys = new ArrayList<SyndEntry>();
		try {
			URL url = new URL("http://www.dnevnik.bg/rssc/?rubrid=1657");
			HttpURLConnection httpcon = (HttpURLConnection) url
					.openConnection();
			// Reading the feed
			SyndFeedInput input = new SyndFeedInput();
			SyndFeed feed = input.build(new XmlReader(httpcon));
			List<SyndEntry> entries = feed.getEntries();
			Iterator<SyndEntry> itEntries = entries.iterator();
			SyndEntry entry;
			StringBuilder siteContent = new StringBuilder();
			while (itEntries.hasNext()) {
				entry = itEntries.next();

				listOfSyndEntrys.add(entry);
			}
			return listOfSyndEntrys;
		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
		return listOfSyndEntrys;

	}
}

















				entry = itEntries.next();
				siteContent.append(entry.getTitle());
				siteContent.append(new ByteArrayImageSource(entry.getTitle().getBytes("UTF-8")));
				siteContent.append("\n");
				siteContent.append(new ByteArrayImageSource(entry.getLink().getBytes("UTF-8")));
				siteContent.append("\n");
				siteContent.append(new ByteArrayImageSource(entry.getAuthor().getBytes("UTF-8")));
				siteContent.append("\n");
				siteContent.append(entry.getPublishedDate());
				siteContent.append("\n");
				siteContent.append(entry.getDescription());
 
